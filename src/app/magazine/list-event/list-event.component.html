<section class="container mt-70p mt-md-100p pb-35p pb-md-65p border-bottom border-line">

  <div class="d-flex">
    <i iconPh="calendar" class="h4 h2-md text-placeholder mr-3"></i>
    <div>
      <h2 class="h4 h2-md">{{category?.title}}</h2>
      <p class="subtitle1 mb-0">
        A collection of 
        <span>
          <span>{{postTotal}} event</span>
          <span *ngIf="postTotal > 1">s</span>
        </span>
      </p>
    </div>
  </div>
</section>

<section class="container mt-70p pb-100p border-bottom border-line">
  <detail-post
  [data]="latest"
  [shorten]="true"
  ></detail-post>
</section>

<section class="container mt-50p" id="archive">
  <div class="row mb-50p flex-column flex-md-row flex-nowrap justify-content-md-between">
    <div class="col">
      <h4 class="h4 mb-0">Upcoming Events</h4>
    </div>
    <div class="col mt-15p mt-md-0 text-right">
      <button 
      class="btn btn-filter subtitle1"
      [ngClass]="{'btn-filter': !isDatePickerActive, 'btn-primary': isDatePickerActive}"
      (click)="showModal('date-picker')"
      >
        <i iconPh="sliders-horiz-2"></i>
        <span>date picker</span>
      </button>
      <button class="btn btn-filter subtitle1 ml-10p" (click)="onOrderChanged()">
        <ng-container *ngIf="order != 'asc'">
          <i iconPh="sort-number-reverse"></i>
          <span *ngIf="!orderBy || orderBy=='startAt'">Latest</span>
        </ng-container>
        <ng-container *ngIf="order == 'asc'">
          <i iconPh="sort-number"></i>
          <span *ngIf="orderBy=='startAt'">Closest</span>
        </ng-container>
      </button>
    </div>
  </div>
  <div class="row">
    <ng-container *ngFor="let p of upcoming; let i = index">
      <div class="col-12 mb-30p mb-md-55p">
        <card-event size="large" [data]="p" [showCategory]="false"></card-event>
      </div>
    </ng-container>
    <ng-container *ngIf="upcoming && upcoming.length == 0">
      <div class="col-12 mb-30p mb-md-55p subtitle1">No upcoming events found...</div>
    </ng-container>
  </div>
</section>

<div class="d-flex align-items-center justify-content-center paginators mb-100p">
  <ng-container *ngFor="let paginatorGroup of paginators; let i = index;">
    <ng-container *ngFor="let page of paginatorGroup; let j = index">
      <a 
      [routerLink]="[(pageCurrent == 1 ? './' : '../') + (page == 1 ? '' : page)]"
      class="btn bg-primary-light mx-2"
      [ngClass]=" {'bg-primary text-white': (pageCurrent == page), 'bg-primary-light text-primary-dark': (pageCurrent != page)}"
      >
        <span>{{page}}</span>
    </a>  
    </ng-container>
    <i iconPh="more-horiz" class="text-primary-dark" *ngIf="paginators.length - 1 > i"></i>
  </ng-container>
</div>


<section class="container mt-50p">
  <div class="row mb-50p flex-column flex-md-row flex-nowrap justify-content-md-between">
    <div class="col">
      <h4 class="h4 mb-0">Past Events</h4>
    </div>
  </div>
  <div class="row">
    <ng-container *ngFor="let p of archive; let i = index">
      <div class="col-12 col-md-4 mb-30p mb-md-55p">
        <card-event size="medium" [data]="p" [showCategory]="false"></card-event>
      </div>
    </ng-container>
    <ng-container *ngIf="archive && archive.length == 0">
      <div class="col-12 mb-30p mb-md-55p subtitle1">No events found...</div>
    </ng-container>
  </div>
</section>

<div class="d-flex align-items-center justify-content-center paginators mb-100p">
  <ng-container *ngFor="let paginatorGroup of paginatorsArchive; let i = index;">
    <ng-container *ngFor="let page of paginatorGroup; let j = index">
      <a       
      class="btn bg-primary-light mx-2"
      [ngClass]=" {'bg-primary text-white': (pageArchiveCurrent == page), 'bg-primary-light text-primary-dark': (pageArchiveCurrent != page)}"
      (click)="changePageArchive(page)"
      >
        <span>{{page}}</span>
      </a>  
    </ng-container>
    <i iconPh="more-horiz" class="text-primary-dark" *ngIf="paginators.length - 1 > i"></i>
  </ng-container>
</div>

<section class="container mt-50p">
  <div class="row mb-50p flex-column flex-md-row flex-nowrap justify-content-md-between">
    <div class="col">
      <h4 class="h4 mb-0">Past Events</h4>
    </div>
  </div>
  <div class="row">
    <ng-container *ngFor="let p of archive; let i = index">
      <div class="col-12 col-md-4 mb-30p mb-md-55p">
        <card-event size="medium" [data]="p" [showCategory]="false"></card-event>
      </div>
    </ng-container>
    <ng-container *ngIf="archive && archive.length == 0">
      <div class="col-12 mb-30p mb-md-55p subtitle1">No events found...</div>
    </ng-container>
  </div>
</section>

<div class="d-flex align-items-center justify-content-center paginators mb-100p">
  <ng-container *ngFor="let paginatorGroup of paginatorsArchive; let i = index;">
    <ng-container *ngFor="let page of paginatorGroup; let j = index">
      <a       
      class="btn bg-primary-light mx-2"
      [ngClass]=" {'bg-primary text-white': (pageArchiveCurrent == page), 'bg-primary-light text-primary-dark': (pageArchiveCurrent != page)}"
      (click)="changePageArchive(page)"
      >
        <span>{{page}}</span>
      </a>  
    </ng-container>
    <i iconPh="more-horiz" class="text-primary-dark" *ngIf="paginatorsArchive.length - 1 > i"></i>
  </ng-container>
</div>

<section>
  <section-signup></section-signup>
</section>


<!-- modal: date picker -->
<div 
*ngIf="isDatePickerShown"
class="modal-view"
>
  <div class="modal-drop"
  (click)="onDatePickerCanceled()"
  ></div>
  <div 
  class="modal-body"
  >

    <div class="title-container d-flex justify-content-between align-items-center">
      <span class="h5 h4-md mr-3 mb-0 flex-grow-1">Date Picker</span>
      <button class="btn pr-0 btn-icon" (click)="onDatePickerCanceled()">
        <i iconPh="cross"></i>
      </button>  
    </div>

    <div class="content-container">
      <p class="body1 text-body mb-30p">Please select preferred date range</p>
      <div class="text-center">

        <!-- <ngb-datepicker #dp 
        (dateSelect)="onDateSelection($event)" 
        [displayMonths]="displayMonths"
        [minDate]="minDate" 
        [dayTemplate]="t" 
        outsideDays="hidden"
        ></ngb-datepicker> -->
        
        <ng-template #t let-date let-focused="focused">
          <span class="custom-day"
          [class.disabled]="isDisabled(date)"
          [class.focused]="focused"
          [class.range]="isRange(date)"
          [class.faded]="isHovered(date) || isInside(date)"
          (mouseenter)="hoveredDate = date"
          (mouseleave)="hoveredDate = null"
          >{{ date.day }}</span>
        </ng-template>

        <div *ngIf="fromDate" class="text-left mt-15p">
          <div class="subtitle1">Selected date</div>
          <div class="body1">
            <span [innerHTML]="convertNgbDateToDate(fromDate) | date: 'longDate'"></span>
            <ng-container *ngIf="toDate">
              <span> - </span>
              <span [innerHTML]="convertNgbDateToDate(toDate) | date: 'longDate'"></span>
            </ng-container>

          </div>
        
        </div>

        <div class="d-flex justify-content-between mt-45p">
          <button
          class="btn btn-outline flex-grow-1 mr-15p"
          (click)="onDatePickerReseted()"
          >Reset</button>

          <button
          class="btn btn-primary flex-grow-1 ml-15p"
          (click)="onDatePickerUpdated()"
          >Update</button>
        </div>
        
      </div>
    </div>

  </div>
</div>

